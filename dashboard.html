<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GenX â€” Admin Dashboard</title>
<style>
  body { font-family: Arial; background: #f0f2f5; margin: 0; padding: 0; }
  .container { max-width: 1000px; margin: 30px auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  h2 { color: #1877f2; text-align: center; }
  input[type="text"] { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 20px; font-size: 14px; box-sizing: border-box; }
  table { width: 100%; border-collapse: collapse; }
  th, td { text-align: left; padding: 10px; border-bottom: 1px solid #ccc; }
  th { background-color: #1877f2; color: white; }
  tr:hover { background-color: #f1f1f1; }
  #logoutBtn { margin-bottom: 20px; padding: 10px; background: #ff4d4f; color: white; border: none; cursor: pointer; border-radius: 8px; }
  #logoutBtn:hover { background: #e03e3e; }
</style>
</head>
<body>

<div class="container">
  <h2>Admin Dashboard â€” Users</h2>
  <button id="logoutBtn">Logout</button>
  <input type="text" id="searchInput" placeholder="Search users by name or email...">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Email</th>
        <th>Gender</th>
        <th>Marital Status</th>
        <th>Location</th>
        <th>DOB</th>
        <th>Bio</th>
        <th>Registered At</th>
      </tr>
    </thead>
    <tbody id="usersTable"></tbody>
  </table>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js"></script>

<script>
  // ðŸ”’ Admin session check
  if(localStorage.getItem('adminLoggedIn') !== 'true'){
    alert("Please login as admin first!");
    window.location.href =login.html';
  }

  // ðŸ”¥ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyAyMhgLjQg9zU1Tq2pFVmRiF_UiOBqPlj0",
    authDomain: "genx-7a5b3.firebaseapp.com",
    databaseURL: "https://genx-7a5b3-default-rtdb.firebaseio.com",
    projectId: "genx-7a5b3",
    storageBucket: "genx-7a5b3.firebasestorage.app",
    messagingSenderId: "1293731877",
    appId: "1:1293731877:web:a330360ade1db5e68897cc"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const usersTable = document.getElementById('usersTable');
  const searchInput = document.getElementById('searchInput');

  let allUsers = [];

  // ðŸ”¹ Load all users
  db.ref("users").on("value", snapshot => {
    allUsers = [];
    usersTable.innerHTML = "";
    snapshot.forEach(childSnapshot => {
      const user = childSnapshot.val();
      allUsers.push(user);
      addUserRow(user);
    });
  });

  function addUserRow(user){
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${user.name}</td>
      <td>${user.email}</td>
      <td>${user.gender}</td>
      <td>${user.maritalStatus || ''}</td>
      <td>${user.location || ''}</td>
      <td>${user.dob}</td>
      <td>${user.bio || ''}</td>
      <td>${new Date(user.time || Date.now()).toLocaleString()}</td>
    `;
    usersTable.appendChild(tr);
  }

  // ðŸ”¹ Search
  searchInput.addEventListener("input", () => {
    const query = searchInput.value.toLowerCase();
    usersTable.innerHTML = "";
    allUsers.filter(user => 
      user.name.toLowerCase().includes(query) || 
      user.email.toLowerCase().includes(query)
    ).forEach(user => addUserRow(user));
  });

  // ðŸ”¹ Logout
  document.getElementById('logoutBtn').addEventListener('click', () => {
    localStorage.removeItem('adminLoggedIn');
    window.location.href = 'admin-login.html';
  });
</script>

</body>
</html>
