<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile Page</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f2f5;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }

    .cover {
      position: relative;
      height: 200px;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 10px;
    }

    .cover img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .profile {
      text-align: center;
      background: white;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
      position: relative;
    }

    .profile img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid white;
      margin-top: -60px;
    }

    .profile h2 {
      margin: 10px 0 5px;
    }

    .profile p {
      color: gray;
      margin: 0;
    }

    .edit-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #1877f2;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
    }

    .post-form {
      background: white;
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 20px;
    }

    .post-form textarea {
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      resize: vertical;
      margin-bottom: 10px;
      border: 1px solid #ccc;
    }

    .post-form input[type="file"] {
      margin-bottom: 10px;
    }

    .post-form button {
      background: #1877f2;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }

    .post {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .post img, .post video {
      width: 100%;
      margin-top: 10px;
      border-radius: 8px;
    }

    .post small {
      color: gray;
      display: block;
      margin-top: 10px;
    }

    .engagement {
      margin-top: 10px;
    }

    .engagement button {
      margin-right: 10px;
      background: none;
      border: none;
      cursor: pointer;
      color: #555;
    }

    .preview img, .preview video {
      width: 100%;
      margin-top: 10px;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<div class="container">
  <!-- Cover Photo -->
  <div class="cover">
    <img id="coverPic" src="https://via.placeholder.com/600x200" alt="Cover" />
  </div>

  <!-- Profile Section -->
  <div class="profile">
    <button class="edit-btn" onclick="window.location.href='authentication.html'">Edit Profile</button>
    <img id="profilePic" src="https://via.placeholder.com/100" alt="Profile" />
    <h2 id="profileName">John Doe</h2>
    <p id="profileBio">Hello from the village!</p>
  </div>

  <!-- Post Form -->
  <div class="post-form">
    <textarea id="postText" placeholder="What's on your mind?" required></textarea>
    <input type="file" id="mediaInput" accept="image/*,video/*" />
    <div class="preview" id="mediaPreview"></div>
    <button onclick="createPost()">Post</button>
  </div>

  <!-- Posts Display -->
  <div id="postsContainer"></div>
</div>

<script>
  let mediaBase64 = "";

  function loadProfile() {
    const data = JSON.parse(localStorage.getItem("profile")) || {
      name: "John Doe",
      bio: "Hello from the village!",
      profilePic: "https://via.placeholder.com/100",
      coverPic: "https://via.placeholder.com/600x200"
    };

    document.getElementById("profileName").innerText = data.name;
    document.getElementById("profileBio").innerText = data.bio;
    document.getElementById("profilePic").src = data.profilePic;
    document.getElementById("coverPic").src = data.coverPic;
  }

  document.getElementById('mediaInput').addEventListener('change', function () {
    const file = this.files[0];
    const preview = document.getElementById('mediaPreview');
    preview.innerHTML = '';
    if (file) {
      const reader = new FileReader();
      reader.onload = function (e) {
        mediaBase64 = e.target.result;
        if (file.type.startsWith('image/')) {
          preview.innerHTML = `<img src="${mediaBase64}" alt="Preview">`;
        } else if (file.type.startsWith('video/')) {
          preview.innerHTML = `<video controls src="${mediaBase64}"></video>`;
        }
      };
      reader.readAsDataURL(file);
    }
  });

  function createPost() {
    const text = document.getElementById('postText').value.trim();
    if (text === "") return alert("Please write something!");

    const profile = JSON.parse(localStorage.getItem("profile")) || { name: "Anonymous" };

    const posts = JSON.parse(localStorage.getItem('posts') || '[]');
    posts.push({
      id: Date.now(),
      text,
      media: mediaBase64,
      type: mediaBase64.startsWith('data:video') ? 'video' : 'image',
      likes: 0,
      timestamp: new Date().toLocaleString(),
      author: profile.name
    });

    localStorage.setItem('posts', JSON.stringify(posts));
    document.getElementById('postText').value = "";
    document.getElementById('mediaInput').value = "";
    document.getElementById('mediaPreview').innerHTML = "";
    mediaBase64 = "";
    showPosts();
  }

  function likePost(postId) {
    const posts = JSON.parse(localStorage.getItem('posts') || '[]');
    const post = posts.find(p => p.id === postId);
    if (post) {
      post.likes += 1;
      localStorage.setItem('posts', JSON.stringify(posts));
      showPosts();
    }
  }

  function showPosts() {
    const posts = JSON.parse(localStorage.getItem('posts') || '[]');
    const container = document.getElementById('postsContainer');
    container.innerHTML = "";

    posts.slice().reverse().forEach(post => {
      const media = post.media ? (post.type === 'video'
        ? `<video controls src="${post.media}"></video>`
        : `<img src="${post.media}" />`) : "";

      container.innerHTML += `
        <div class="post">
          <strong>${post.author || "Unknown User"}</strong>
          <p>${post.text}</p>
          ${media}
          <div class="engagement">
            <button onclick="likePost(${post.id})">üëç Like (${post.likes})</button>
            <button>üí¨ Comment</button>
            <button>‚Üó Share</button>
          </div>
          <small>${post.timestamp}</small>
        </div>
      `;
    });
  }

  window.onload = () => {
    loadProfile();
    showPosts();
  };
</script>

</body>
</html>
