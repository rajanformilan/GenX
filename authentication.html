<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GenX — Profile Setup</title>
<style>
  body { font-family: Arial; background: #f0f2f5; margin: 0; }
  .container { max-width: 600px; margin: 30px auto; background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  h2 { color: #1877f2; }
  input, select, textarea, button { width: 100%; margin: 8px 0; padding: 10px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box; font-size: 14px; }
  button { background: #1877f2; color: white; border: none; cursor: pointer; }
  button:hover { background: #165ec9; }
  .step { display: none; }
  .step.active { display: block; }
  .profile-display { text-align: center; }
  .profile-display img { width: 100px; height: 100px; border-radius: 50%; margin: 10px; }
  .cover-display { width: 100%; height: 150px; object-fit: cover; border-radius: 10px; margin-bottom: 10px; }
</style>
</head>
<body>

<div class="container">
  <!-- Step 1: Basic Info -->
  <div class="step active" id="step1">
    <h2>Step 1: Basic Info</h2>
    <input type="text" id="firstName" placeholder="First Name" required>
    <input type="email" id="email" placeholder="Email" required>
    
    <select id="gender" required>
      <option value="">Select Gender</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
      <option value="Other">Other</option>
    </select>

    <input type="date" id="dob" placeholder="Date of Birth" required>

    <!-- New Fields -->
    <input type="text" id="qualification" placeholder="Qualification">
    
    <select id="workingStatus">
      <option value="">Working Status</option>
      <option value="Employed">Employed</option>
      <option value="Self-Employed">Self-Employed</option>
      <option value="Student">Student</option>
      <option value="Unemployed">Unemployed</option>
    </select>

    <select id="maritalStatus">
      <option value="">Marital Status</option>
      <option value="Single">Single</option>
      <option value="Married">Married</option>
      <option value="Divorced">Divorced</option>
    </select>

    <input type="text" id="location" placeholder="Location">

    <button id="next1">Next</button>
    <div style="text-align:center; margin-top:15px;">
  <p>
    Already have an account? 
    <a href="login.html" style="color:#1877f2; text-decoration:none;">Login</a>
  </p>
</div>

  </div>

  <!-- Step 2: Avatar, Cover, Bio -->
  <div class="step" id="step2">
    <h2>Step 2: Profile & Cover</h2>
    <label>Profile Picture:</label>
    <input type="file" id="profilePic" accept="image/*">
    <label>Cover Photo:</label>
    <input type="file" id="coverPic" accept="image/*">
    <label>Bio:</label>
    <textarea id="bio" placeholder="Write a short bio..." rows="3"></textarea>
    <button id="next2">Next</button>
  </div>

  <!-- Step 3: Review & Edit -->
  <div class="step" id="step3">
    <h2>Step 3: Review & Save</h2>
    <div class="profile-display">
      <img id="displayProfile" src="https://via.placeholder.com/100" alt="Profile">
      <h3 id="displayName"></h3>
      <p id="displayEmail"></p>
      <p id="displayGender"></p>
      <p id="displayDob"></p>
      <img id="displayCover" class="cover-display" src="https://via.placeholder.com/600x150" alt="Cover">
      <p id="displayBio"></p>
      <p id="extraInfo"></p>
    </div>
    <button id="editBtn">Edit Info</button>
    <button id="saveBtn">Save Profile</button>
  </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyAyMhgLjQg9zU1Tq2pFVmRiF_UiOBqPlj0",
    authDomain: "genx-7a5b3.firebaseapp.com",
    projectId: "genx-7a5b3",
    storageBucket: "genx-7a5b3.firebasestorage.app",
    messagingSenderId: "1293731877",
    appId: "1:1293731877:web:a330360ade1db5e68897cc"
  };
  firebase.initializeApp(firebaseConfig);

  // Elements
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const step3 = document.getElementById('step3');
  const next1 = document.getElementById('next1');
  const next2 = document.getElementById('next2');
  const editBtn = document.getElementById('editBtn');
  const saveBtn = document.getElementById('saveBtn');

  const firstName = document.getElementById('firstName');
  const email = document.getElementById('email');
  const gender = document.getElementById('gender');
  const dob = document.getElementById('dob');
  const qualification = document.getElementById('qualification');
  const workingStatus = document.getElementById('workingStatus');
  const maritalStatus = document.getElementById('maritalStatus');
  const location = document.getElementById('location');
  const profilePic = document.getElementById('profilePic');
  const coverPic = document.getElementById('coverPic');
  const bio = document.getElementById('bio');

  const displayName = document.getElementById('displayName');
  const displayEmail = document.getElementById('displayEmail');
  const displayGender = document.getElementById('displayGender');
  const displayDob = document.getElementById('displayDob');
  const displayProfile = document.getElementById('displayProfile');
  const displayCover = document.getElementById('displayCover');
  const displayBio = document.getElementById('displayBio');
  const extraInfo = document.getElementById('extraInfo');

  let profileData = {};

  // Step 1 → Step 2
  next1.addEventListener('click', () => {
    if(!firstName.value || !email.value || !gender.value || !dob.value){
      alert('Please fill all mandatory fields!');
      return;
    }
    profileData.name = firstName.value;
    profileData.email = email.value;
    profileData.gender = gender.value;
    profileData.dob = dob.value;
    profileData.qualification = qualification.value || '';
    profileData.workingStatus = workingStatus.value || '';
    profileData.maritalStatus = maritalStatus.value || '';
    profileData.location = location.value || '';

    step1.classList.remove('active');
    step2.classList.add('active');
  });

  // Step 2 → Step 3 (with Firebase Storage)
  next2.addEventListener('click', () => {
    profileData.bio = bio.value || '';
    let uploadsDone = 0;

    function checkAllDone(){
      uploadsDone++;
      if(uploadsDone === 2){
        showReview();
        step2.classList.remove('active');
        step3.classList.add('active');
      }
    }

    // Profile Pic Upload
    if(profilePic.files[0]){
      const profileRef = firebase.storage().ref('profiles/' + Date.now() + '_' + profilePic.files[0].name);
      profileRef.put(profilePic.files[0]).then(snapshot => {
        snapshot.ref.getDownloadURL().then(url => {
          profileData.avatar = url;
          checkAllDone();
        });
      });
    } else { profileData.avatar = "https://via.placeholder.com/100"; checkAllDone(); }

    // Cover Pic Upload
    if(coverPic.files[0]){
      const coverRef = firebase.storage().ref('covers/' + Date.now() + '_' + coverPic.files[0].name);
      coverRef.put(coverPic.files[0]).then(snapshot => {
        snapshot.ref.getDownloadURL().then(url => {
          profileData.cover = url;
          checkAllDone();
        });
      });
    } else { profileData.cover = "https://via.placeholder.com/600x150"; checkAllDone(); }
  });

  function showReview(){
    displayName.textContent = profileData.name;
    displayEmail.textContent = "Email: " + profileData.email;
    displayGender.textContent = "Gender: " + profileData.gender;
    displayDob.textContent = "DOB: " + profileData.dob;
    displayProfile.src = profileData.avatar;
    displayCover.src = profileData.cover;
    displayBio.textContent = profileData.bio;
    extraInfo.innerHTML = `Qualification: ${profileData.qualification} <br>
                           Working: ${profileData.workingStatus} <br>
                           Marital: ${profileData.maritalStatus} <br>
                           Location: ${profileData.location}`;
  }

  // Edit
  editBtn.addEventListener('click', () => {
    step3.classList.remove('active');
    step1.classList.add('active');
    firstName.value = profileData.name;
    email.value = profileData.email;
    gender.value = profileData.gender;
    dob.value = profileData.dob;
    qualification.value = profileData.qualification;
    workingStatus.value = profileData.workingStatus;
    maritalStatus.value = profileData.maritalStatus;
    location.value = profileData.location;
    bio.value = profileData.bio;
  });

  // Save to Firebase Database
  saveBtn.addEventListener('click', () => {
    const newUserRef = firebase.database().ref('users/' + Date.now());
    newUserRef.set(profileData)
      .then(() => alert('Profile saved to Firebase successfully!'))
      .catch(err => alert('Error: ' + err.message));
  });
</script>
</body>
</html>
